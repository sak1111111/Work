Вопросы для самоконтроля по Express.js

1. В чем преимущества использования Express.js по сравнению с чистым Node.js для создания серверов?
   - Упрощенный синтаксис и меньше boilerplate-кода
   - Встроенная система маршрутизации (routing)
   - Middleware-архитектура для обработки запросов
   - Автоматическая обработка заголовков и MIME-типов
   - Шаблонизаторы для рендеринга HTML
   - Большое количество готовых middleware-пакетов
   - Упрощенная работа с cookies и сессиями
   - Лучшая структуризация кода приложения

2. Что такое middleware в Express.js и каков порядок их выполнения?
   Middleware - это функции, которые имеют доступ к объектам запроса (req), ответа (res) и следующей функции middleware в цикле запрос-ответ.
   
   Порядок выполнения:
   - Middleware выполняются в порядке их регистрации в приложении
   - Каждый middleware должен вызвать next() для передачи управления следующему middleware
   - Если middleware не вызывает next(), цепочка обработки прерывается
   - Ошибки передаются в middleware обработки ошибок через next(error)

3. Как организовать модульную структуру роутеров в Express приложении?
   - Создать отдельные файлы для каждого роутера в папке routes/
   - Использовать express.Router() для создания модульных обработчиков маршрутов
   - Экспортировать роутер из модуля
   - Подключить роутеры в основном файле приложения с помощью app.use()
   
   Пример:
   // routes/users.js
   const router = express.Router();
   router.get('/', (req, res) => { ... });
   module.exports = router;
   
   // app.js
   const usersRouter = require('./routes/users');
   app.use('/users', usersRouter);

4. Какие методы роутинга поддерживает Express.js и для чего они используются?
   - GET - получение ресурсов
   - POST - создание новых ресурсов
   - PUT - полное обновление ресурсов
   - PATCH - частичное обновление ресурсов
   - DELETE - удаление ресурсов
   - ALL - обработка всех HTTP-методов для указанного пути
   - Используются через app.METHOD() или router.METHOD()

5. Как обрабатывать параметры URL и query-параметры в Express?
   Параметры URL (route parameters):
   - Определяются в пути маршрута: /users/:id
   - Доступны через req.params (req.params.id)
   
   Query-параметры:
   - Передаются в URL после ?: /users?page=1&limit=10
   - Доступны через req.query (req.query.page, req.query.limit)

6. В чем разница между app.use() и app.METHOD()?
   - app.use() регистрирует middleware для ВСЕХ HTTP-методов на указанном пути
   - app.METHOD() (app.get(), app.post() и т.д.) регистрирует обработчики для КОНКРЕТНЫХ HTTP-методов
   - app.use() может обрабатывать все запросы, начинающиеся с указанного пути
   - app.METHOD() обрабатывает точное совпадение пути и метода

7. Как организовать централизованную обработку ошибок в Express приложении?
   - Создать специальный middleware с четырьмя параметрами: (err, req, res, next)
   - Разместить его после всех других app.use() и маршрутов
   - Передавать ошибки через next(error) из любого места приложения
   - В обработчике ошибок определять тип ошибки и отправлять соответствующий ответ
   
   Пример:
   app.use((err, req, res, next) => {
     console.error(err.stack);
     res.status(500).json({ error: 'Something went wrong!' });
   });

8. Что такое router.param() и для чего он используется?
   router.param() - это middleware, которое выполняется когда в пути встречается определенный параметр.
   
   Используется для:
   - Валидации параметров маршрута
   - Преобразования параметров (например, из строки в число)
   - Загрузки данных из базы данных по параметру
   - Выполнения общих операций для маршрутов с определенным параметром
   
   Пример:
   router.param('userId', (req, res, next, userId) => {
     User.findById(userId, (err, user) => {
       if (err) return next(err);
       if (!user) return res.status(404).send('User not found');
       req.user = user;
       next();
     });
   });